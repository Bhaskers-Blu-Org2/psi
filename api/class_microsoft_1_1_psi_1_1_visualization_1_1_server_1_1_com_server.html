<!-- Copyright (c) Microsoft Corporation. All rights reserved.
     Licensed under the MIT License. -->
<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.8.14" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Platform for Situated Intelligence: Microsoft.Psi.Visualization.Server.ComServer Class Reference</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="customdoxygen.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
    <div id="top">
        <!-- do not remove this div, it is closed by doxygen! -->
        <div id="titlearea">
            <table cellspacing="0" cellpadding="0">
                <tbody>
                    <tr style="height: 56px;">
                        <td id="projectalign" style="padding-left: 0.5em;">
                            <div id="projectname">Platform for Situated Intelligence</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <!-- end header part --><!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_microsoft.html">Microsoft</a></li><li class="navelem"><a class="el" href="namespace_microsoft_1_1_psi.html">Psi</a></li><li class="navelem"><a class="el" href="namespace_microsoft_1_1_psi_1_1_visualization.html">Visualization</a></li><li class="navelem"><a class="el" href="namespace_microsoft_1_1_psi_1_1_visualization_1_1_server.html">Server</a></li><li class="navelem"><a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html">ComServer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Microsoft.Psi.Visualization.Server.ComServer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ComServer encapsulates the skeleton of an out-of-process COM server in C#. The class implements the singleton design pattern and it's thread-safe. To start the server, call CoMServer.Instance.Run(). If the server is running, the function returns directly. Inside the Run method, it registers the class factories for the COM classes to be exposed from the COM server, and starts the message loop to wait for the drop of lock count to zero. When lock count equals zero, it revokes the registrations and quits the server.  
 <a href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a93973cbd36c4dde64ac1cb528fc3e413"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html#a93973cbd36c4dde64ac1cb528fc3e413">Initialize</a> (Guid clsid, <a class="el" href="interface_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_i_class_factory.html">IClassFactory</a> factory)</td></tr>
<tr class="memdesc:a93973cbd36c4dde64ac1cb528fc3e413"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize is responsible for registering the COM class factories for the COM classes to be exposed from the server, and initializing the key member variables of the COM server (e.g. mainThreadId and lockCount).  <a href="#a93973cbd36c4dde64ac1cb528fc3e413">More...</a><br /></td></tr>
<tr class="separator:a93973cbd36c4dde64ac1cb528fc3e413"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ea61de5f1da8195aac27241eb7ada3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html#a36ea61de5f1da8195aac27241eb7ada3">Uninitialize</a> ()</td></tr>
<tr class="memdesc:a36ea61de5f1da8195aac27241eb7ada3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Uninitialize is called to revoke the registration of the COM classes exposed from the server, and perform the cleanups.  <a href="#a36ea61de5f1da8195aac27241eb7ada3">More...</a><br /></td></tr>
<tr class="separator:a36ea61de5f1da8195aac27241eb7ada3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31372d3656d75981d26bdcd96cef7000"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html#a31372d3656d75981d26bdcd96cef7000">Lock</a> ()</td></tr>
<tr class="memdesc:a31372d3656d75981d26bdcd96cef7000"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increase the lock count  <a href="#a31372d3656d75981d26bdcd96cef7000">More...</a><br /></td></tr>
<tr class="separator:a31372d3656d75981d26bdcd96cef7000"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d436e038763d87dc1c2c4a657f30ac7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html#a6d436e038763d87dc1c2c4a657f30ac7">Unlock</a> ()</td></tr>
<tr class="memdesc:a6d436e038763d87dc1c2c4a657f30ac7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrease the lock count. When the lock count drops to zero, post the WM_QUIT message to the message loop in the main thread to shut down the COM server.  <a href="#a6d436e038763d87dc1c2c4a657f30ac7">More...</a><br /></td></tr>
<tr class="separator:a6d436e038763d87dc1c2c4a657f30ac7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a2e9dd93af687df20b563a7401e545d28"><td class="memItemLeft" align="right" valign="top">static readonly <a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html">ComServer</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html#a2e9dd93af687df20b563a7401e545d28">Instance</a> = new <a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html">ComServer</a>()</td></tr>
<tr class="memdesc:a2e9dd93af687df20b563a7401e545d28"><td class="mdescLeft">&#160;</td><td class="mdescRight">The singleton instance of the <a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html" title="ComServer encapsulates the skeleton of an out-of-process COM server in C#. The class implements the s...">ComServer</a>.  <a href="#a2e9dd93af687df20b563a7401e545d28">More...</a><br /></td></tr>
<tr class="separator:a2e9dd93af687df20b563a7401e545d28"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ComServer encapsulates the skeleton of an out-of-process COM server in C#. The class implements the singleton design pattern and it's thread-safe. To start the server, call CoMServer.Instance.Run(). If the server is running, the function returns directly. Inside the Run method, it registers the class factories for the COM classes to be exposed from the COM server, and starts the message loop to wait for the drop of lock count to zero. When lock count equals zero, it revokes the registrations and quits the server. </p>
<p>The lock count of the server is incremented when a COM object is created, and it's decremented when the object is released (GC-ed). </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a93973cbd36c4dde64ac1cb528fc3e413"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93973cbd36c4dde64ac1cb528fc3e413">&#9670;&nbsp;</a></span>Initialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Microsoft.Psi.Visualization.Server.ComServer.Initialize </td>
          <td>(</td>
          <td class="paramtype">Guid&#160;</td>
          <td class="paramname"><em>clsid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="interface_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_i_class_factory.html">IClassFactory</a>&#160;</td>
          <td class="paramname"><em>factory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize is responsible for registering the COM class factories for the COM classes to be exposed from the server, and initializing the key member variables of the COM server (e.g. mainThreadId and lockCount). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">clsid</td><td>The server CLSID.</td></tr>
    <tr><td class="paramname">factory</td><td>The server class factory.</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a31372d3656d75981d26bdcd96cef7000"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31372d3656d75981d26bdcd96cef7000">&#9670;&nbsp;</a></span>Lock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Microsoft.Psi.Visualization.Server.ComServer.Lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Increase the lock count </p>
<dl class="section return"><dt>Returns</dt><dd>The new lock count after the increment</dd></dl>
<p>The method is thread-safe.</p>

</div>
</div>
<a id="a36ea61de5f1da8195aac27241eb7ada3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36ea61de5f1da8195aac27241eb7ada3">&#9670;&nbsp;</a></span>Uninitialize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Microsoft.Psi.Visualization.Server.ComServer.Uninitialize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Uninitialize is called to revoke the registration of the COM classes exposed from the server, and perform the cleanups. </p>

</div>
</div>
<a id="a6d436e038763d87dc1c2c4a657f30ac7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d436e038763d87dc1c2c4a657f30ac7">&#9670;&nbsp;</a></span>Unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Microsoft.Psi.Visualization.Server.ComServer.Unlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Decrease the lock count. When the lock count drops to zero, post the WM_QUIT message to the message loop in the main thread to shut down the COM server. </p>
<dl class="section return"><dt>Returns</dt><dd>The new lock count after the increment</dd></dl>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a2e9dd93af687df20b563a7401e545d28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9dd93af687df20b563a7401e545d28">&#9670;&nbsp;</a></span>Instance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">readonly <a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html">ComServer</a> Microsoft.Psi.Visualization.Server.ComServer.Instance = new <a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html">ComServer</a>()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The singleton instance of the <a class="el" href="class_microsoft_1_1_psi_1_1_visualization_1_1_server_1_1_com_server.html" title="ComServer encapsulates the skeleton of an out-of-process COM server in C#. The class implements the s...">ComServer</a>. </p>

</div>
</div>
</div><!-- contents -->
<!-- Copyright (c) Microsoft Corporation. All rights reserved.
     Licensed under the MIT License. -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer" />
<address class="footer">
  <small>
    <a href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy & Cookies</a>&nbsp;|&nbsp;
    <a href="https://go.microsoft.com/fwlink/?LinkId=246338">Terms Of Use</a>&nbsp;|&nbsp;
    <a href="https://go.microsoft.com/fwlink/?LinkId=506942">Trademarks</a>&nbsp;|&nbsp; &nbsp;&#9400;&nbsp;Microsoft
    <img class="footer" src="MSLogoGreySmall.png" alt="Microsoft" Height="40" /> Generated by&nbsp;
    <a href="http://www.doxygen.org/index.html">
      <img class="footer" src="doxygen.png" alt="doxygen" />
    </a>1.8.14
  </small>
</address>
</body>
</html>